# ISC_final_project
This is the GitHub repository of my ISC final project, which includes the R codes as well as a brief README file.

## R packages required
ggplot2

## Running the codes
This GitHub repository contains mainly two sets of files -- data files (seq_data_\*.txt) and R codes (\*.R). And in order to test the codes, you need to pull all files into your local laptop (Mac or Linux system only).

After downloading all files (excluding files in parallel_version_alpha folder), you can simply see the result by running run.R file, which will load data from 5 files (seq_data_1.txt to seq_data_5.txt), import functions from functions_codes.R file, and calculate the likelihood of different selection coefficients. The log-likelihoods of different selection coefficients are saved in a data.frame called result, which is then used to plot the data using ggplot2.

If everything works well (which it should, as I have tested it on both Mac and CentOS systems), you shall be able to see the following plot, indicating that the most probably selection coefficient is s = 0.8.

![Correct Results](https://github.com/wenhan-uchicago/ISC_final_project/blob/master/result.png)

## Introcution
This is a Maximum-Likelihood estimator for deducing the most probable selection coefficient from Evolution-Resequencing experiment (ER) data [1]. As a simple ER experiment example, suppose we are selecting 100 fruitflies for their body size for 100 generations. And as well all know, body size is a classic example of Quantitative Trait that is contributed by hundreds of Quantitattive Trait Loci (QTL). Therefore, unlike classic Mendelian genetics, the specific genes that are responsible for body size could not be easily discovered. One way to do so is by QTL-mapping, which is tedious and less-efficient; another way is to conduct an Evolution-Resequencing (ER) experiment, since those genes responsible for body size would increase their allelic frequencies after ~100 generations of selection. 

However, since the population size is normally small in ER experiments [2], the effect of genetic drift, gene frequency change caused by randomness, cannot be omitted. Past method relied on using Chi-squared test to discover genomic regions that have undergone dramatic differentiation after selection [2], which was proven to be useless by simulation data. Therefore, the availability of cheap Next-Generation Sequencing (NGS) data urges for an sensitive way to detect loci under selection, which I present here by using a model based maximum likelihood estimator.

## Materials and Methods

### Input files
The five data files (seq_data_1.txt to seq_data_5.txt) were generated by another ad hoc R script that follows the classic Wright-Fisher model, with a user-defined selection coefficient s = 0.8. And the first column means the sequence depth from NGS,  second column means absolute frequency of allele A, and the third column means the number of generations. For example, the first line in seq_data_1.txt is "97      52      1", which means that in Genration 1, the sequence depth is 97 and the frequency of allele A is 52. There are 5 different files, because in ER experiment it is required to have multiple replicates. Therefore, these five data files represent five independent replications under exactly the same conditions.

### R Functions
In functions_codes.R file, 



## Reference
1. Kofler R, Schl√∂tterer C. A guide for the design of evolve and resequencing studies. Molecular biology and evolution. 2014 Feb 1;31(2):474-83.
 
2.	Baldwin-Brown JG, Long AD, Thornton KR. The power to detect quantitative trait loci using resequenced, experimentally evolved populations of diploid, sexual organisms. Molecular biology and evolution. 2014;31(4):1040-55.
